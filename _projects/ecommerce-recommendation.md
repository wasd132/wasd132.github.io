---
layout: project
title: "이커머스 데이터 기반 개인화 추천 시스템"
summary: "DACON 이커머스 고객 거래 데이터를 활용하여, Apriori 연관 규칙 마이닝과 LGBMRanker 기반 LTR(Learning to Rank) 모델을 결합한 하이브리드 상품 추천 시스템입니다. 단순한 상품 유사도 기반 추천이 아닌, 고객·상품 특성을 피처로 학습하여 개인화된 추천 순위를 제공합니다."
image: assets/images/raspberry-pi-monitor.png
technologies: [Python, Apriori, LightGBM, LGBMRanker, Pandas, Kaggle]
github:
categories: ml
---

## 프로젝트 배경

2025년 이커머스 시장에서 맞춤형 제품과 서비스가 핵심 경쟁력으로 부상하고 있습니다. 그러나 대규모 상품 카탈로그에서 각 고객에게 적합한 상품을 추천하는 것은 복잡성과 비용 문제를 수반합니다. 이를 해결하기 위해 데이터 기반 추천 시스템이 필수적이며, 본 프로젝트는 **T-SUM 데이터 분석/인공지능 경진대회**를 위해 멘토링 팀(BIG_PY)에서 진행한 프로젝트입니다.

DACON에서 제공하는 이커머스 고객 거래 데이터셋(Customer, Online Sales, Discount, Marketing, Tax)을 활용하여, 협업 필터링과 콘텐츠 기반 필터링을 결합한 하이브리드 모델로 고객 만족도를 높이는 개인화 추천 시스템을 구축했습니다.

## 주요 기능

### 1. 데이터 탐색 및 전처리 (EDA)
고객 거래 데이터의 특성을 파악하고 추천 시스템에 적합한 형태로 전처리합니다. 5개의 데이터셋(Customer, Online Sales, Discount, Marketing, Tax)을 통합·분석하여 유의미한 인사이트를 도출했습니다.

### 2. Apriori 연관 규칙 마이닝
거래 데이터에서 상품 간 연관 관계를 도출합니다. 최소 지지도와 신뢰도를 낮게 설정하여 최대한 많은 연관 규칙(약 45만 개)을 생성한 뒤, Lift(향상도)를 기준으로 상품당 상위 5개의 유사 아이템을 추출하여 ItemSimilar 테이블을 구성합니다.

### 3. LTR(Learning to Rank) 기반 개인화 랭킹
단순한 상품 유사도 기반 추천을 넘어, 고객 ID·성별·지역·상품 카테고리·금액 등의 피처를 학습하여 개인화된 추천 순위를 제공합니다. LGBMRanker 모델을 사용하여 lambdarank 손실 함수로 학습했으며, 평균 NDCG 0.867의 성능을 달성했습니다.

### 4. 트렌드 기반 추천 시스템
월별 판매량과 재구매율을 결합한 트렌드 점수를 계산하여, 시기별로 인기 있는 상품을 추천합니다. StandardScaler로 정규화한 후 월별 상위 5개 상품을 추출하는 Rule-based 추천 방식입니다.

### 5. Kaggle 노트북 기반 협업 환경
VSCode Live Share 시도 후 Kaggle 노트북으로 협업 환경을 구축하여, 팀원 간 실시간 코드 셰어링과 모델 실험을 진행했습니다.

## 데이터셋 분석

DACON 이커머스 고객 거래 데이터셋을 사용했습니다.

| 데이터셋 | 주요 컬럼 | 활용 |
|---------|---------|------|
| Customer | 고객ID, 성별, 고객지역, 가입기간 | 고객 특성 피처, 지역별 선호도 분석 |
| Online Sales | 고객ID, 제품ID, 제품카테고리, 거래날짜, 수량, 평균금액 | 거래 이력 기반 연관 규칙, LTR 학습 데이터 |
| Discount | 제품카테고리, 쿠폰코드, 할인율 | 카테고리별 할인 효과 분석 |
| Marketing | 날짜, 오프라인비용, 온라인비용 | 마케팅 비용과 거래액 상관관계 분석 |
| Tax | 제품카테고리, GST | 세금 분석 |

### EDA 주요 발견사항
- 고객당 연간 평균 **30개** 상품 구매 (일회성 이용이 아닌 지속적 플랫폼 사용)
- 유저들이 한 카테고리 내에서 여러 종류의 상품을 구매하는 패턴
- **8월** 거래량이 가장 높으며, 상위 판매 상품(Apparel, Nest-USA, Office)이 전체 거래량 변화에 큰 영향
- 마케팅 비용과 거래액 간 뚜렷한 상관관계 없음 (비용 최고점 1/5, 2/27의 거래액 미미)
- 할인율은 3개월 주기로 고정(1,4,7,10월 10% / 2,5,8,11월 20% / 3,6,9,12월 30%)
- 남성과 여성의 선호 카테고리 분포는 거의 유사
- 신규 가입자(0~5개월) 중 여성 비율이 남성 대비 약 200% 이상

## 추천 알고리즘 파이프라인

```
[1단계: 연관 규칙 마이닝 (Apriori)]
  ├── 거래 데이터를 트랜잭션 포맷으로 변환 (One-Hot Encoding)
  ├── 최소 지지도 0.004, 최소 신뢰도 0.4로 빈발 항목 집합 생성
  ├── 약 45만 개의 연관 규칙 도출
  └── Lift 기준으로 상품당 상위 5개 유사 아이템 추출 → ItemSimilar 테이블

[2단계: 학습 데이터 구성]
  ├── 실제 구매 상품: 점수 6점 (또는 1점)
  ├── 유사 상품 5개: Lift 순위에 따라 5,4,3,2,1점 (또는 0.8~0.2점)
  ├── 비관련 상품 3개: 랜덤 샘플링, 점수 0점
  └── 고객·상품 피처 결합: 성별, 고객지역, 제품카테고리, 평균금액

[3단계: LTR 모델 학습 (LGBMRanker)]
  ├── 범주형 변수 Label Encoding
  ├── 고객 ID별 그룹화 (GroupShuffleSplit)
  ├── 손실 함수: lambdarank
  └── 평균 NDCG: 0.867

[4단계: 추천 결과 생성]
  ├── 랭킹을 예측하고 구매한 데이터를 제외
  └── 상위 N개 상품을 추천 결과로 노출
```

## 기술 스택

- **Python + Pandas** — 데이터 전처리, EDA, 피벗 테이블 생성, 데이터셋 병합
- **mlxtend (Apriori)** — TransactionEncoder로 트랜잭션 변환, 빈발 항목 집합 및 연관 규칙 생성
- **LightGBM (LGBMRanker)** — Learning to Rank 모델, lambdarank 손실 함수, 피처 중요도 시각화
- **pandasql** — SQL 기반 데이터 조인으로 학습 데이터셋 구성
- **Matplotlib + Seaborn + Plotly** — EDA 시각화 (월별 거래 추이, 카테고리 분포, 성별 분석)
- **scikit-learn** — StandardScaler 정규화, NDCG 성능 평가, GroupShuffleSplit
- **Kaggle Notebook** — 협업 환경, 데이터셋 로드 및 모델 학습

## 담당 업무

3명의 멘티(고하영, 김동현, 이영기)를 지도하는 **멘토**로서, 프로젝트 주제 선정부터 데이터 분석, 모델 설계, 발표까지 전 과정을 이끌었습니다.

### 1. 멘토링 및 프로젝트 관리

T-SUM 데이터 분석/인공지능 경진대회를 준비하는 팀(BIG_PY)의 멘토로서, 10주간(10/3~12월) 주 1회 멘토링 세션을 진행하며 프로젝트 전반을 관리했습니다.

- 10/3 OT에서 간단한 코딩 테스트로 멘티들의 수준을 파악한 뒤, Python 기초(변수, 연산자)부터 Pandas, CSV 파일 처리, matplotlib 시각화까지 단계적으로 교육을 진행했습니다.
- 정형 데이터와 비정형 데이터의 차이점, 데이터 전처리 과정에 대한 교육을 진행하고, weka를 활용한 Decision Tree 학습 연습 등 머신러닝 기초를 가르쳤습니다.
- 멘티 3명의 주제 의견(경영지표 예측 / 소비 패턴 기반 추천 / 이미지 객체 탐지)을 수렴한 뒤, 데이터 확보 가능성과 경진대회 적합성을 고려하여 **김동현 의견(신용카드 사용 기록 기반 상품 추천)**을 최종 주제로 선정했습니다.
- 데이터셋 선정 시 서울시 공공데이터와 DACON 데이터셋 두 가지 방안을 제안했으며, 공공데이터의 칼럼 수 부족 및 표본 정보 한계를 확인한 후 **DACON 이커머스 고객 거래 데이터셋**으로 결정했습니다.

### 2. 데이터 분석 설계 및 EDA 지도

멘티들이 각자 하나의 데이터셋을 분석하도록 업무를 분배하고, 분석 방향과 시각화 방법을 지도했습니다.

- 멘티 고하영에게는 전체 데이터셋의 주요 컬럼 분석(고객·제품·거래 관련 분포)과 고객군 식별을 담당하도록 했으며, 성별·지역·가입기간별 고객 분포 분석 및 카테고리별 할인 효과 분석의 프레임워크를 제시했습니다.
- 각 멘티가 분석해온 결과에 대해 피드백을 진행하고, 유의미한 인사이트(월별 거래량 추이, 상위 판매 상품의 영향력, 쿠폰 사용 패턴 등)를 함께 도출했습니다.
- 협업 도구로 Kaggle 노트북과 VSCode Live Share를 시도했으나, 기술적 문제로 Kaggle 노트북으로 최종 결정하여 코드 셰어링 환경을 구축했습니다.

### 3. 추천 알고리즘 설계 및 구현

단순 상품 유사도 기반 추천이 아닌, **연관 규칙 마이닝 + LTR 모델을 결합한 하이브리드 추천 시스템**의 전체 아키텍처를 설계했습니다.

- Apriori 알고리즘으로 상품 간 연관 규칙을 분석하고, Lift 기준 상위 5개 유사 아이템을 추출하는 파이프라인을 구현했습니다. 최소 지지도(0.004)와 신뢰도(0.4)를 조정하여 약 45만 개의 연관 규칙을 생성했습니다.
- LTR 학습 데이터 구성 체계를 설계했습니다: 실제 구매 상품(6점), 유사 상품 5개(Lift 순위에 따른 점수), 비관련 상품 3개(0점)로 점수 체계를 정의하고, 고객·상품 피처를 결합한 학습 데이터셋을 구성했습니다.
- LGBMRanker 모델을 선정하고 lambdarank 손실 함수를 적용하여 학습했습니다. XGBoost 등 다른 모델의 장단점을 비교한 후 LightGBM의 빠른 학습 속도와 랭킹 최적화 특성을 고려하여 최종 결정했습니다.
- 별도로 월별 판매량과 재구매율을 결합한 **트렌드 기반 Rule-based 추천 시스템**도 설계하여, 시기별 인기 상품을 보조 추천으로 제공할 수 있도록 했습니다.

### 4. 모델 평가 및 발표

완성된 추천 시스템의 성능을 평가하고, 경진대회 발표자료를 제작했습니다.

- NDCG@k(Normalized Discounted Cumulative Gain)를 평가 지표로 선정하여 그룹별 NDCG를 계산하고, **평균 NDCG 0.867**을 달성했습니다.
- 피처 중요도를 시각화하여 모델이 어떤 피처를 중시하는지 분석하고, 모델 관리가 용이하도록 설계했습니다.
- 경진대회 발표자료(12페이지)를 제작하여 프로젝트 배경, 데이터 분석, 알고리즘 설계, 성과를 체계적으로 발표했습니다.

## 성과

- **T-SUM 데이터 분석/인공지능 경진대회** 최우수상 수상 (2024.12)
- 하이브리드 추천 시스템 설계: Apriori 연관 규칙 + LGBMRanker LTR 결합
- NDCG 0.867 달성
- 멘토로서 3명의 멘티를 지도하며 데이터 분석 기초부터 ML 모델링까지 교육
